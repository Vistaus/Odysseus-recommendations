<!DOCTYPE html>
<html>
<head>
  <title>Welcome to Odysseus!</title>
  <style>
    body {
      font: medium sans-serif;
      text-align: center;
    }
    ul {display: block;}
    li {display: inline;}
    img {height: 128px; width: 128px;}
  </style>
  <script src="zepto.js"></script>
  <script>
    var lang = navigator.language.split("-")[0]
    // Make sure we're translating to a supported locale.
    if ("en".split(" ").indexOf(lang) < 0) lang = "en"

    $.get("tsv/" + lang + ".tsv", (text) => $(() => {
        var tsv = text.split("\n").map((tuple) => tuple.split("\t"))
            .filter((tuple) => tuple.length > 1)
        tsv.map((tuple) => tuple.push(Math.random() * tuple[0]))
        tsv.sort((a, b) => a[3] - b[3])
        tsv = tsv.slice(0, 40)
        $('ul').empty()
        var tuple
        for (tuple of tsv)
          $('ul').append($('<li>').append(
            $('<a>').attr('href', tuple[1]).append(
              $('<img>').attr('src', "data:image/png;base64," + tuple[2])
            )
          ))

        console.log(tuple)
    }))
  </script>
</head>
<body>
  <h1>Here's some cool links for you to check out!</h1>

  <ul><li>Loading...</li></ul>

  <p>These links are honest recommendations from <a href="https://github.com/alcinnz">Adrian Cochrane</a>, maintainer of the <a href="https://alcinnz.github.io/Odysseus/">Odysseus Web Browser</a>. None of them paid to be added to this list.</p>
  <p>Many of these links are passed on in good-faith from Defective By Design's <a href="https://www.defectivebydesign.org/guide">Guide to DRM Free Living</a>.</p>
</body>
</html>
